// Copyright AGNTCY Contributors (https://github.com/agntcy)
// SPDX-License-Identifier: Apache-2.0

syntax = "proto3";

package agntcy.dir.naming.v1;

import "agntcy/dir/naming/v1/domain_verification.proto";

// NamingService provides methods to verify and check domain ownership.
service NamingService {
  // VerifyDomain performs domain ownership verification for a signed record.
  // This should be called after signing a record to verify and store the domain ownership proof.
  rpc VerifyDomain(VerifyDomainRequest) returns (VerifyDomainResponse);

  // CheckDomainVerification checks if a record has verified domain ownership.
  rpc CheckDomainVerification(CheckDomainVerificationRequest) returns (CheckDomainVerificationResponse);
}

// VerifyDomainRequest is the request for performing domain verification.
message VerifyDomainRequest {
  // The CID of the signed record to verify.
  string cid = 1;
}

// VerifyDomainResponse is the response for domain verification.
message VerifyDomainResponse {
  // Whether the domain verification succeeded.
  bool verified = 1;

  // The domain verification details (only set if verified is true).
  DomainVerification verification = 2;

  // Error message if verification failed.
  optional string error_message = 3;
}

// CheckDomainVerificationRequest is the request for checking domain verification.
message CheckDomainVerificationRequest {
  // The CID of the record to check.
  string cid = 1;
}

// CheckDomainVerificationResponse is the response for checking domain verification.
message CheckDomainVerificationResponse {
  // Whether the record has verified domain ownership.
  bool verified = 1;

  // The domain verification details (only set if verified is true).
  DomainVerification verification = 2;

  // Error message if verification lookup failed.
  optional string error_message = 3;
}
