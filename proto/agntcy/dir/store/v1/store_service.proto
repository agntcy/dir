// Copyright AGNTCY Contributors (https://github.com/agntcy)
// SPDX-License-Identifier: Apache-2.0

syntax = "proto3";

package agntcy.dir.store.v1;

import "agntcy/dir/store/v1/object.proto";
import "google/protobuf/empty.proto";

// Defines an interface for content-addressable storage
// service for arbitrary objects.
// Supports DAG structure creation via object linking.
//
// Objects are mapped to OCI artifacts, and stored in OCI-compliant
// format.
// The object references map OCI digest to CIDs.
service StoreService {
  // Push performs write operation for given objects.
  // Data is streamed in chunks.
  rpc Push(stream Object) returns (ObjectRef);

  // Pull performs read operation for given objects.
  // Data is streamed in chunks.
  rpc Pull(ObjectRef) returns (stream Object);

  // Lookup resolves basic metadata for the objects.
  // Does not stream data.
  rpc Lookup(ObjectRef) returns (Object);

  // Remove performs delete operation for the objects.
  rpc Delete(ObjectRef) returns (google.protobuf.Empty);

  // Walk lists all linked objects starting from the given root objects.
  // Use Pull to retrieve actual data.
  rpc Walk(ObjectRef) returns (stream Object);
}
