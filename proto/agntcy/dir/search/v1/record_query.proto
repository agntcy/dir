// Copyright AGNTCY Contributors (https://github.com/agntcy)
// SPDX-License-Identifier: Apache-2.0

syntax = "proto3";

package agntcy.dir.search.v1;

// A query to match the record against during discovery.
// For example:
//   Exact match:      { type: RECORD_QUERY_TYPE_NAME, value: "my-agent" }
//   Wildcard match:   { type: RECORD_QUERY_TYPE_NAME, value: "web*" }
//   Pattern match:    { type: RECORD_QUERY_TYPE_SKILL_NAME, value: "*machine*learning*" }
//   Question mark:    { type: RECORD_QUERY_TYPE_VERSION, value: "v1.0.?" }
//   Complex match:    { type: RECORD_QUERY_TYPE_LOCATOR, value: "docker-image:https://*.example.com/*" }
message RecordQuery {
  // The type of the query to match against.
  RecordQueryType type = 1;

  // The query value to match against.
  // Supports wildcard patterns:
  //   '*' - matches zero or more characters
  //   '?' - matches exactly one character
  string value = 2;
}

// Defines a list of supported record query types.
enum RecordQueryType {
  // Unspecified query type.
  RECORD_QUERY_TYPE_UNSPECIFIED = 0;

  // Query for a record name.
  // Supports wildcard patterns: "web*", "*service", "api-*-v2", "???api"
  RECORD_QUERY_TYPE_NAME = 1;

  // Query for a record version.
  // Supports wildcard patterns: "v1.*", "v2.*", "*-beta", "v1.0.?"
  RECORD_QUERY_TYPE_VERSION = 2;

  // Query for a skill ID.
  // Numeric field - exact match only, no wildcard support.
  RECORD_QUERY_TYPE_SKILL_ID = 3;

  // Query for a skill name.
  // Supports wildcard patterns: "python*", "*script", "*machine*learning*", "Pytho?"
  RECORD_QUERY_TYPE_SKILL_NAME = 4;

  // Query for a locator type.
  // Supports wildcard patterns: "http*", "ftp*", "*docker*"
  RECORD_QUERY_TYPE_LOCATOR = 5;

  // Query for a module name.
  // Supports wildcard patterns: "*-plugin", "*-module", "core*", "mod-?"
  RECORD_QUERY_TYPE_MODULE_NAME = 6;

  // Query for a domain ID.
  // Numeric field - exact match only, no wildcard support.
  RECORD_QUERY_TYPE_DOMAIN_ID = 7;

  // Query for a domain name.
  // Supports wildcard patterns: "*education*", "healthcare/*", "*technology"
  RECORD_QUERY_TYPE_DOMAIN_NAME = 8;

  // Query for a record's created_at timestamp.
  // Supports wildcard patterns for date strings: "2025-*", ">=2025-01-01"
  RECORD_QUERY_TYPE_CREATED_AT = 9;

  // Query for a record author.
  // Supports wildcard patterns: "AGNTCY*", "*@example.com", "*Team*"
  RECORD_QUERY_TYPE_AUTHOR = 10;

  // Query for a schema version.
  // Supports wildcard patterns: "0.7.*", "0.*", "1.0.?"
  RECORD_QUERY_TYPE_SCHEMA_VERSION = 11;

  // Query for a module ID.
  // Numeric field - exact match only, no wildcard support.
  RECORD_QUERY_TYPE_MODULE_ID = 12;

  // Query for verified records (name ownership verified via JWKS).
  // Boolean field - use "true" or "false" as value.
  RECORD_QUERY_TYPE_VERIFIED = 13;
}
