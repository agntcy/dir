# Directory API Server Configuration
# Environment variable prefix: DIRECTORY_SERVER

# API Configuration
DIRECTORY_SERVER_LISTEN_ADDRESS=0.0.0.0:8888

# OASF Validation Configuration
# Schema URL for validating OASF records (required for record validation)
DIRECTORY_SERVER_OASF_API_VALIDATION_SCHEMA_URL=https://schema.oasf.outshift.com

# Logging Configuration
DIRECTORY_SERVER_LOGGING_VERBOSE=false

# SPIRE Authentication Configuration (JWT or X.509)
# Modes: "jwt" or "x509"
DIRECTORY_SERVER_AUTHN_ENABLED=false
DIRECTORY_SERVER_AUTHN_MODE=x509
DIRECTORY_SERVER_AUTHN_SOCKET_PATH=
DIRECTORY_SERVER_AUTHN_AUDIENCES=

# SPIRE Authorization Configuration
DIRECTORY_SERVER_AUTHZ_ENABLED=false
DIRECTORY_SERVER_AUTHZ_ENFORCER_POLICY_FILE_PATH=/etc/agntcy/dir/authz_policies.csv

# Store Configuration (OCI Registry)
DIRECTORY_SERVER_STORE_PROVIDER=oci
DIRECTORY_SERVER_STORE_OCI_LOCAL_DIR=
DIRECTORY_SERVER_STORE_OCI_CACHE_DIR=
DIRECTORY_SERVER_STORE_OCI_REGISTRY_ADDRESS=zot:5000
DIRECTORY_SERVER_STORE_OCI_REPOSITORY_NAME=dir
DIRECTORY_SERVER_STORE_OCI_AUTH_CONFIG_INSECURE=true
DIRECTORY_SERVER_STORE_OCI_AUTH_CONFIG_USERNAME=
DIRECTORY_SERVER_STORE_OCI_AUTH_CONFIG_PASSWORD=
DIRECTORY_SERVER_STORE_OCI_AUTH_CONFIG_ACCESS_TOKEN=
DIRECTORY_SERVER_STORE_OCI_AUTH_CONFIG_REFRESH_TOKEN=

# Routing Configuration (P2P/DHT)
DIRECTORY_SERVER_ROUTING_LISTEN_ADDRESS=/ip4/0.0.0.0/tcp/8999
DIRECTORY_SERVER_ROUTING_DIRECTORY_API_ADDRESS=
DIRECTORY_SERVER_ROUTING_BOOTSTRAP_PEERS=
DIRECTORY_SERVER_ROUTING_KEY_PATH=
DIRECTORY_SERVER_ROUTING_DATASTORE_DIR=
DIRECTORY_SERVER_ROUTING_GOSSIPSUB_ENABLED=true

# Database Configuration (PostgreSQL)
DIRECTORY_SERVER_DATABASE_TYPE=postgres
DIRECTORY_SERVER_DATABASE_POSTGRES_HOST=postgres
DIRECTORY_SERVER_DATABASE_POSTGRES_PORT=5432
DIRECTORY_SERVER_DATABASE_POSTGRES_DATABASE=directory
DIRECTORY_SERVER_DATABASE_POSTGRES_USERNAME=postgres
DIRECTORY_SERVER_DATABASE_POSTGRES_PASSWORD=postgres
DIRECTORY_SERVER_DATABASE_POSTGRES_SSL_MODE=disable

# Sync Configuration (credentials for sync operations)
DIRECTORY_SERVER_SYNC_AUTH_CONFIG_USERNAME=
DIRECTORY_SERVER_SYNC_AUTH_CONFIG_PASSWORD=

# Publication Configuration (DHT publication scheduler)
DIRECTORY_SERVER_PUBLICATION_SCHEDULER_INTERVAL=1h
DIRECTORY_SERVER_PUBLICATION_WORKER_COUNT=1
DIRECTORY_SERVER_PUBLICATION_WORKER_TIMEOUT=30m

# Events Configuration (internal event bus)
DIRECTORY_SERVER_EVENTS_SUBSCRIBER_BUFFER_SIZE=100
DIRECTORY_SERVER_EVENTS_LOG_SLOW_CONSUMERS=true
DIRECTORY_SERVER_EVENTS_LOG_PUBLISHED_EVENTS=false

# Metrics Configuration (Prometheus)
DIRECTORY_SERVER_METRICS_ENABLED=true
DIRECTORY_SERVER_METRICS_ADDRESS=:9090

# Rate Limiting Configuration
DIRECTORY_SERVER_RATELIMIT_ENABLED=false
DIRECTORY_SERVER_RATELIMIT_GLOBAL_RPS=0
DIRECTORY_SERVER_RATELIMIT_GLOBAL_BURST=0
DIRECTORY_SERVER_RATELIMIT_PER_CLIENT_RPS=100
DIRECTORY_SERVER_RATELIMIT_PER_CLIENT_BURST=200

# Logger Configuration (shared across components)
# Log levels: DEBUG, INFO, WARN, ERROR
# Log formats: json, text
DIRECTORY_LOGGER_LOG_LEVEL=DEBUG
DIRECTORY_LOGGER_LOG_FORMAT=json
